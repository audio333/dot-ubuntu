#!/bin/sh

file="$HOME/.local/share/saved/snippets"
bookmark="$(xclip -o)"

add () {
  [ -z "$bookmark" ] && exit

  if grep -q "^$bookmark$" "$file"; then
    notify-send "Oops. Already bookmarked!"
  else
    echo "$bookmark" >> "$file"
    notify-send "Bookmark added! ${bookmark} is now saved to the file."
  fi
}

update () {
  setsid -f "$TERMINAL" -e nvim $file >/dev/null 2>&1
}

selected () {
  choice=$(echo " Save\n Edit\n$(grep -v '^#' "$file")" | dmenu -l 50 -i -p "Choose snippets or add new: ")
  case $choice in
    " Save") add ;;
    " Edit") update ;;
    *) xdotool type "$choice" ;;
  esac
}

selected
